<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Oracle's Wisdom</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <header>
    <h1>The Oracle's Wisdom</h1>
    <p class="tagline">"Verstrewn leaves of consulta'ed consoles tell a story."</p>
  </header>

  <main>
    <!-- Summary Stats Bar -->
    <section class="stats-bar">
      <div class="stat-item" id="stat-commits">
        <span class="stat-value">--</span>
        <span class="stat-label">commits tracked</span>
      </div>
      <div class="stat-item pass" id="stat-pass">
        <span class="stat-value">--</span>
        <span class="stat-label">passing</span>
      </div>
      <div class="stat-item fail" id="stat-fail">
        <span class="stat-value">--</span>
        <span class="stat-label">failing</span>
      </div>
      <div class="stat-item" id="stat-rate">
        <span class="stat-value">--</span>
        <span class="stat-label">pass rate</span>
      </div>
      <div class="stat-item" id="stat-rng">
        <span class="stat-value">--</span>
        <span class="stat-label">RNG parity</span>
      </div>
    </section>

    <!-- Chart Controls -->
    <section class="controls">
      <div class="control-group">
        <span class="control-label">View:</span>
        <button class="view-btn" data-view="tests">Tests</button>
        <button class="view-btn active" data-view="categories">Categories</button>
        <button class="view-btn" data-view="metrics">Metrics</button>
      </div>
      <div class="control-group">
        <span class="control-label">Range:</span>
        <button class="range-btn" data-range="50">50</button>
        <button class="range-btn" data-range="100">100</button>
        <button class="range-btn active" data-range="all">All</button>
      </div>
      <div class="control-group" id="test-controls" style="display:none;">
        <label class="checkbox-label">
          <input type="checkbox" id="show-pass" checked> Pass
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="show-fail" checked> Fail
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="show-rate"> Rate %
        </label>
      </div>
      <div class="control-group" id="metrics-controls" style="display:none;">
        <label class="checkbox-label">
          <input type="checkbox" id="show-rng" checked> RNG
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="show-screens" checked> Screens
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="show-grids" checked> Grids
        </label>
      </div>
      <div class="control-group zoom-controls">
        <button id="zoom-reset" title="Reset zoom">&#x27F2;</button>
        <span class="zoom-hint">Drag to zoom, scroll to pan</span>
      </div>
    </section>

    <!-- Main Timeline Chart -->
    <section class="chart-section">
      <div class="chart-container">
        <canvas id="timeline-chart"></canvas>
      </div>
    </section>

    <!-- Category Breakdown (shown when Categories view active) -->
    <section class="breakdown-section" id="category-breakdown">
      <h2>Failures by Category <span class="section-hint">(The Oracle knows what remains)</span></h2>
      <div class="category-grid" id="category-grid"></div>
    </section>


    <!-- Commit Table -->
    <section class="table-section">
      <h2>Commit History <span class="section-hint">(The Oracle remembers all)</span></h2>
      <div class="table-container">
        <table id="commit-table">
          <thead>
            <tr>
              <th class="col-commit">Commit</th>
              <th class="col-date">Date</th>
              <th class="col-message">Message</th>
              <th class="col-pass">Pass</th>
              <th class="col-fail">Fail</th>
              <th class="col-delta">&Delta;</th>
              <th class="col-rng">RNG</th>
              <th class="col-sessions">Sessions</th>
            </tr>
          </thead>
          <tbody id="commit-tbody"></tbody>
        </table>
      </div>
    </section>

    <!-- Detail Panel (shown on row click) -->
    <section class="detail-panel" id="detail-panel" style="display: none;">
      <div class="detail-header">
        <span class="detail-title" id="detail-title">Commit Details</span>
        <button class="detail-close" id="detail-close">&times;</button>
      </div>
      <div class="detail-content" id="detail-content"></div>
    </section>
  </main>

  <footer>
    <p>
      <span class="footer-quote">"Pay thy consultancy fee and the Oracle shall reveal the truth of thy tests."</span>
      <br>
      <a href="https://github.com/davidbau/mazesofmenace">Mazes of Menace</a> &middot;
      Data from <code>refs/notes/test-results</code>
    </p>
  </footer>

  <script src="dashboard.js"></script>
</body>
</html>
